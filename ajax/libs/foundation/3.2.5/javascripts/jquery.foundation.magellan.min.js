(function(e,t){"use strict";e.fn.foundationMagellan=function(n){var i=e(t),r=e(document),o=e("[data-magellan-expedition=fixed]"),a={threshold:o.length?o.outerHeight(!0):0,activeClass:"active"},n=e.extend({},a,n);r.on("magellan.arrival","[data-magellan-arrival]",function(){var t=e(this),i=t.closest("[data-magellan-expedition]"),r=i.attr("data-magellan-active-class")||n.activeClass;t.closest("[data-magellan-expedition]").find("[data-magellan-arrival]").not(this).removeClass(r),t.addClass(r)});var s=e("[data-magellan-expedition]");s.find("[data-magellan-arrival]:first").addClass(s.attr("data-magellan-active-class")||n.activeClass),o.on("magellan.update-position",function(){var t=e(this);t.data("magellan-fixed-position",""),t.data("magellan-top-offset","")}).trigger("magellan.update-position"),i.on("resize.magellan",function(){o.trigger("magellan.update-position")}),i.on("scroll.magellan",function(){var t=i.scrollTop();o.each(function(){var i=e(this);""===i.data("magellan-top-offset")&&i.data("magellan-top-offset",i.offset().top);var r=t+n.threshold>i.data("magellan-top-offset");i.data("magellan-fixed-position")!=r&&(i.data("magellan-fixed-position",r),r?i.css({position:"fixed",top:0}):i.css({position:"",top:""}))})});var l=e("[data-magellan-destination]:last");l.length>0&&i.on("scroll.magellan",function(){var t=i.scrollTop(),o=t+i.outerHeight(!0),a=Math.ceil(l.offset().top);e("[data-magellan-destination]").each(function(){var i=e(this),s=i.attr("data-magellan-destination"),l=i.offset().top-t;n.threshold>=l&&e("[data-magellan-arrival="+s+"]").trigger("magellan.arrival"),o>=r.outerHeight(!0)&&a>t&&o>a&&e("[data-magellan-arrival]:last").trigger("magellan.arrival")})})}})(jQuery,this);