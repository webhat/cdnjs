(function(e,t){"use strict";Foundation.libs.topbar={name:"topbar",version:"4.0.0",settings:{index:0,stickyClass:"sticky",back_text:"&laquo; Back",init:!1},init:function(n,i,r){var o=this;return this.scope=n||this.scope,"object"==typeof i&&e.extend(!0,this.settings,i),"string"!=typeof i?(e("nav.top-bar").each(function(){o.settings.$w=e(t),o.settings.$topbar=e(this),o.settings.$section=o.settings.$topbar.find("section"),o.settings.$titlebar=o.settings.$topbar.children("ul").first(),o.settings.$topbar.data("index",0);var n=e("<div class='top-bar-js-breakpoint'/>").insertAfter(o.settings.$topbar);o.settings.breakPoint=n.width(),n.remove(),o.assemble(),o.settings.$topbar.parent().hasClass("fixed")&&e("body").css("padding-top",o.outerHeight(o.settings.$topbar))}),o.settings.init||this.events(),this.settings.init):this[i].call(this,r)},events:function(){var n=this;e(this.scope).on("click.fndtn.topbar",".top-bar .toggle-topbar",function(t){var i=e(this).closest(".top-bar"),r=i.find("section, .section");i.children("ul").first(),n.settings.$topbar.data("height")||n.largestUL(),t.preventDefault(),n.breakpoint()&&i.toggleClass("expanded").css("min-height",""),i.hasClass("expanded")||(r.css({left:"0%"}),r.find(">.name").css({left:"100%"}),r.find("li.moved").removeClass("moved"),i.data("index",0))}).on("click.fndtn.topbar",".top-bar .has-dropdown>a",function(t){var i=e(this).closest(".top-bar"),r=i.find("section, .section"),o=i.children("ul").first();if((Modernizr.touch||n.breakpoint())&&t.preventDefault(),n.breakpoint()){var a=e(this),s=a.closest("li");i.data("index",i.data("index")+1),s.addClass("moved"),r.css({left:-(100*i.data("index"))+"%"}),r.find(">.name").css({left:100*i.data("index")+"%"}),a.siblings("ul").height(i.data("height")+n.outerHeight(o,!0)),i.css("min-height",i.data("height")+2*n.outerHeight(o,!0))}}),e(t).on("resize.fndtn.topbar",function(){this.breakpoint()||e(".top-bar").css("min-height","")}.bind(this)),e(this.scope).on("click.fndtn",".top-bar .has-dropdown .back",function(t){t.preventDefault();var n=e(this),i=n.closest(".top-bar"),r=i.find("section, .section"),o=n.closest("li.moved");o.parent(),i.data("index",i.data("index")-1),r.css({left:-(100*i.data("index"))+"%"}),r.find(">.name").css({left:100*i.data("index")+"%"}),0===i.data("index")&&i.css("min-height",0),setTimeout(function(){o.removeClass("moved")},300)})},breakpoint:function(){return e(t).width()<=this.settings.breakPoint||e("html").hasClass("lt-ie9")},assemble:function(){var t=this;this.settings.$section.detach(),this.settings.$section.find(".has-dropdown>a").each(function(){var n=e(this),i=n.siblings(".dropdown"),r=e('<li class="title back js-generated"><h5><a href="#">'+t.settings.back_text+"</a></h5></li>");i.prepend(r)}),this.settings.$section.appendTo(this.settings.$topbar),this.sticky()},largestUL:function(){var t=this.settings.$topbar.find("section ul ul"),n=t.first(),i=0,r=this;t.each(function(){e(this).children("li").length>n.children("li").length&&(n=e(this))}),n.children("li").each(function(){i+=r.outerHeight(e(this),!0)}),this.settings.$topbar.data("height",i)},sticky:function(){var n="."+this.settings.stickyClass;if(e(n).length>0){var i=e(n).length?e(n).offset().top:0,r=e(t),o=this.outerHeight(e("nav.top-bar"))+20;r.scroll(function(){r.scrollTop()>=i?(e(n).addClass("fixed"),e("body").css("padding-top",o)):i>r.scrollTop()&&(e(n).removeClass("fixed"),e("body").css("padding-top","0"))})}},off:function(){e(this.scope).off(".fndtn.topbar"),e(t).off(".fndtn.topbar")}}})(Foundation.zj,this,this.document);