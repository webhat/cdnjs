(function(t){"use strict";var e=t.document,n=t.setTimeout||n,r=t.clearTimeout||r,a=t.setInterval||a,i=t.History=t.History||{};if(i.initHtml4!==void 0)throw Error("History.js HTML4 Support has already been loaded...");i.initHtml4=function(){return i.initHtml4.initialized!==void 0?!1:(i.initHtml4.initialized=!0,i.enabled=!0,i.savedHashes=[],i.isLastHash=function(t){var e,n=i.getHashByIndex();return e=t===n},i.isHashEqual=function(t,e){return t=encodeURIComponent(t).replace(/%25/g,"%"),e=encodeURIComponent(e).replace(/%25/g,"%"),t===e},i.saveHash=function(t){return i.isLastHash(t)?!1:(i.savedHashes.push(t),!0)},i.getHashByIndex=function(t){var e=null;return e=t===void 0?i.savedHashes[i.savedHashes.length-1]:0>t?i.savedHashes[i.savedHashes.length+t]:i.savedHashes[t]},i.discardedHashes={},i.discardedStates={},i.discardState=function(t,e,n){var r,a=i.getHashByState(t);return r={discardedState:t,backState:n,forwardState:e},i.discardedStates[a]=r,!0},i.discardHash=function(t,e,n){var r={discardedHash:t,backState:n,forwardState:e};return i.discardedHashes[t]=r,!0},i.discardedState=function(t){var e,n=i.getHashByState(t);return e=i.discardedStates[n]||!1},i.discardedHash=function(t){var e=i.discardedHashes[t]||!1;return e},i.recycleState=function(t){var e=i.getHashByState(t);return i.discardedState(t)&&delete i.discardedStates[e],!0},i.emulated.hashChange&&(i.hashChangeInit=function(){i.checkerFunction=null;var n,r,o,s,l="",u=Boolean(i.getHash());return i.isInternetExplorer()?(n="historyjs-iframe",r=e.createElement("iframe"),r.setAttribute("id",n),r.setAttribute("src","#"),r.style.display="none",e.body.appendChild(r),r.contentWindow.document.open(),r.contentWindow.document.close(),o="",s=!1,i.checkerFunction=function(){if(s)return!1;s=!0;var e=i.getHash(),n=i.getHash(r.contentWindow.document.location);return e!==l?(l=e,n!==e&&(o=n=e,r.contentWindow.document.open(),r.contentWindow.document.close(),r.contentWindow.document.location.hash=i.escapeHash(e)),i.Adapter.trigger(t,"hashchange")):n!==o&&(o=n,u&&""===n?i.back():i.setHash(n,!1)),s=!1,!0}):i.checkerFunction=function(){var e=i.getHash()||"";return e!==l&&(l=e,i.Adapter.trigger(t,"hashchange")),!0},i.intervalList.push(a(i.checkerFunction,i.options.hashChangeInterval)),!0},i.Adapter.onDomLoad(i.hashChangeInit)),i.emulated.pushState&&(i.onHashChange=function(e){var n,r=e&&e.newURL||i.getLocationHref(),a=i.getHashByUrl(r),o=null,s=null;return i.isLastHash(a)?(i.busy(!1),!1):(i.doubleCheckComplete(),i.saveHash(a),a&&i.isTraditionalAnchor(a)?(i.Adapter.trigger(t,"anchorchange"),i.busy(!1),!1):(o=i.extractState(i.getFullUrl(a||i.getLocationHref()),!0),i.isLastSavedState(o)?(i.busy(!1),!1):(s=i.getHashByState(o),n=i.discardedState(o),n?(i.getHashByIndex(-2)===i.getHashByState(n.forwardState)?i.back(!1):i.forward(!1),!1):(i.pushState(o.data,o.title,encodeURI(o.url),!1),!0))))},i.Adapter.bind(t,"hashchange",i.onHashChange),i.pushState=function(e,n,r,a){if(r=encodeURI(r).replace(/%25/g,"%"),i.getHashByUrl(r))throw Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(a!==!1&&i.busy())return i.pushQueue({scope:i,callback:i.pushState,args:arguments,queue:a}),!1;i.busy(!0);var o=i.createStateObject(e,n,r),s=i.getHashByState(o),l=i.getState(!1),u=i.getHashByState(l),c=i.getHash(),d=i.expectedStateId==o.id;return i.storeState(o),i.expectedStateId=o.id,i.recycleState(o),i.setTitle(o),s===u?(i.busy(!1),!1):(i.saveState(o),d||i.Adapter.trigger(t,"statechange"),!i.isHashEqual(s,c)&&!i.isHashEqual(s,i.getShortUrl(i.getLocationHref()))&&i.setHash(s,!1),i.busy(!1),!0)},i.replaceState=function(e,n,r,a){if(r=encodeURI(r).replace(/%25/g,"%"),i.getHashByUrl(r))throw Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(a!==!1&&i.busy())return i.pushQueue({scope:i,callback:i.replaceState,args:arguments,queue:a}),!1;i.busy(!0);var o=i.createStateObject(e,n,r),s=i.getHashByState(o),l=i.getState(!1),u=i.getHashByState(l),c=i.getStateByIndex(-2);return i.discardState(l,o,c),s===u?(i.storeState(o),i.expectedStateId=o.id,i.recycleState(o),i.setTitle(o),i.saveState(o),i.Adapter.trigger(t,"statechange"),i.busy(!1)):i.pushState(o.data,o.title,o.url,!1),!0}),i.emulated.pushState&&i.getHash()&&!i.emulated.hashChange&&i.Adapter.onDomLoad(function(){i.Adapter.trigger(t,"hashchange")}),void 0)},i.init!==void 0&&i.init()})(window);