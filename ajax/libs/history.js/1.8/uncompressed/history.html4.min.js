(function(t){"use strict";var e=t.document,n=t.setTimeout||n,r=t.clearTimeout||r,a=t.setInterval||a,o=t.History=t.History||{};if(o.initHtml4!==undefined)throw Error("History.js HTML4 Support has already been loaded...");o.initHtml4=function(){return o.initHtml4.initialized!==undefined?!1:(o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(t){var e,n=o.getHashByIndex();return e=t===n},o.isHashEqual=function(t,e){return t=encodeURIComponent(t).replace(/%25/g,"%"),e=encodeURIComponent(e).replace(/%25/g,"%"),t===e},o.saveHash=function(t){return o.isLastHash(t)?!1:(o.savedHashes.push(t),!0)},o.getHashByIndex=function(t){var e=null;return e=t===undefined?o.savedHashes[o.savedHashes.length-1]:0>t?o.savedHashes[o.savedHashes.length+t]:o.savedHashes[t]},o.discardedHashes={},o.discardedStates={},o.discardState=function(t,e,n){var r,a=o.getHashByState(t);return r={discardedState:t,backState:n,forwardState:e},o.discardedStates[a]=r,!0},o.discardHash=function(t,e,n){var r={discardedHash:t,backState:n,forwardState:e};return o.discardedHashes[t]=r,!0},o.discardedState=function(t){var e,n=o.getHashByState(t);return e=o.discardedStates[n]||!1},o.discardedHash=function(t){var e=o.discardedHashes[t]||!1;return e},o.recycleState=function(t){var e=o.getHashByState(t);return o.discardedState(t)&&delete o.discardedStates[e],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var n,r,i,s,l="",u=Boolean(o.getHash());return o.isInternetExplorer()?(n="historyjs-iframe",r=e.createElement("iframe"),r.setAttribute("id",n),r.setAttribute("src","#"),r.style.display="none",e.body.appendChild(r),r.contentWindow.document.open(),r.contentWindow.document.close(),i="",s=!1,o.checkerFunction=function(){if(s)return!1;s=!0;var e=o.getHash(),n=o.getHash(r.contentWindow.document.location);return e!==l?(l=e,n!==e&&(i=n=e,r.contentWindow.document.open(),r.contentWindow.document.close(),r.contentWindow.document.location.hash=o.escapeHash(e)),o.Adapter.trigger(t,"hashchange")):n!==i&&(i=n,u&&""===n?o.back():o.setHash(n,!1)),s=!1,!0}):o.checkerFunction=function(){var e=o.getHash()||"";return e!==l&&(l=e,o.Adapter.trigger(t,"hashchange")),!0},o.intervalList.push(a(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(e){var n,r=e&&e.newURL||o.getLocationHref(),a=o.getHashByUrl(r),i=null,s=null;return o.isLastHash(a)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(a),a&&o.isTraditionalAnchor(a)?(o.Adapter.trigger(t,"anchorchange"),o.busy(!1),!1):(i=o.extractState(o.getFullUrl(a||o.getLocationHref()),!0),o.isLastSavedState(i)?(o.busy(!1),!1):(s=o.getHashByState(i),(n=o.discardedState(i))?(o.getHashByIndex(-2)===o.getHashByState(n.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(i.data,i.title,encodeURI(i.url),!1),!0))))},o.Adapter.bind(t,"hashchange",o.onHashChange),o.pushState=function(e,n,r,a){if(r=encodeURI(r).replace(/%25/g,"%"),o.getHashByUrl(r))throw Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(a!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:a}),!1;o.busy(!0);var i=o.createStateObject(e,n,r),s=o.getHashByState(i),l=o.getState(!1),u=o.getHashByState(l),c=o.getHash(),d=o.expectedStateId==i.id;return o.storeState(i),o.expectedStateId=i.id,o.recycleState(i),o.setTitle(i),s===u?(o.busy(!1),!1):(o.saveState(i),d||o.Adapter.trigger(t,"statechange"),o.isHashEqual(s,c)||o.isHashEqual(s,o.getShortUrl(o.getLocationHref()))||o.setHash(s,!1),o.busy(!1),!0)},o.replaceState=function(e,n,r,a){if(r=encodeURI(r).replace(/%25/g,"%"),o.getHashByUrl(r))throw Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(a!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:a}),!1;o.busy(!0);var i=o.createStateObject(e,n,r),s=o.getHashByState(i),l=o.getState(!1),u=o.getHashByState(l),c=o.getStateByIndex(-2);return o.discardState(l,i,c),s===u?(o.storeState(i),o.expectedStateId=i.id,o.recycleState(i),o.setTitle(i),o.saveState(i),o.Adapter.trigger(t,"statechange"),o.busy(!1)):o.pushState(i.data,i.title,i.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(t,"hashchange")}),undefined)},o.init!==undefined&&o.init()})(window);