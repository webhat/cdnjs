JXG.GeogebraReader=new function(){this.ggbAct=function(e,t,n){var i,r,o,a=t,s=n;switch(e.toLowerCase()){case"end":return a;case"coord":return i=JXG.GeogebraReader.board.ggbElements[a]?'JXG.getRef(JXG.GeogebraReader.board, "'+a+'")':a,r=JXG.GeogebraReader.board.ggbElements[s]?'JXG.getRef(JXG.GeogebraReader.board, "'+s+'")':s,[i,r];case"le":return"( ("+a+") <= ("+s+") )";case"ge":return"( ("+a+") >= ("+s+") )";case"eq":return"( ("+a+") == ("+s+") )";case"neq":return"( ("+a+") != ("+s+") )";case"lt":return"( ("+a+") < ("+s+") )";case"gt":return"( ("+a+") > ("+s+") )";case"add":return JXG.GeogebraReader.isGGBVector(a)&&JXG.GeogebraReader.isGGBVector(s)?[1,a[1]+"+"+s[1],a[2]+"+"+s[2]]:(i=JXG.isString(a)&&!a.match(/JXG\.getRef\(JXG\.GeogebraReader\.board, "(.+?)"\)\./)&&a.match(/JXG\.getRef/)?[a+".X()",a+".Y()"]:a,r=JXG.isString(s)&&!s.match(/JXG\.getRef\(JXG\.GeogebraReader\.board, "(.+?)"\)\./)&&s.match(/JXG\.getRef/)?[s+".X()",s+".Y()"]:s,JXG.GeogebraReader.isGGBVector(i)&&JXG.isArray(r)?[i[1]+"+"+r[0],i[2]+"+"+r[1]]:JXG.GeogebraReader.isGGBVector(r)&&JXG.isArray(i)?[r[1]+"+"+i[0],r[2]+"+"+i[1]]:JXG.isArray(i)&&JXG.isArray(r)?[i[0]+" + "+r[0],i[1]+" + "+r[1]]:(JXG.isNumber(i)||JXG.isString(i))&&(JXG.isNumber(r)||JXG.isString(r))?i+" + "+r:(JXG.isNumber(i)||JXG.isString(i))&&JXG.isArray(r)?[i+" + "+r[0],i+" + "+r[1]]:JXG.isArray(i)&&(JXG.isNumber(r)||JXG.isString(r))?[i[0]+" + "+r,i[1]+" + "+r]:i+" + "+r);case"sub":return JXG.GeogebraReader.isGGBVector(a)&&JXG.GeogebraReader.isGGBVector(s)?[1,a[1]+"-"+s[1],a[2]+"-"+s[2]]:(i=JXG.isString(a)&&!a.match(/JXG\.getRef\(JXG\.GeogebraReader\.board, "(.+?)"\)\./)&&a.match(/JXG\.getRef/)?[a+".X()",a+".Y()"]:a,r=JXG.isString(s)&&!s.match(/JXG\.getRef\(JXG\.GeogebraReader\.board, "(.+?)"\)\./)&&s.match(/JXG\.getRef/)?[s+".X()",s+".Y()"]:s,JXG.GeogebraReader.isGGBVector(i)&&JXG.isArray(r)?[i[1]+"-"+r[0],i[2]+"-"+r[1]]:JXG.isArray(i)&&JXG.GeogebraReader.isGGBVector(r)?[i[0]+"-("+r[1]+")",i[1]+"-("+r[2]+")"]:JXG.isArray(i)&&JXG.isArray(r)?[i[0]+" - "+r[0],i[1]+" - "+r[1]]:(JXG.isNumber(i)||JXG.isString(i))&&(JXG.isNumber(r)||JXG.isString(r))?i+" - "+r:(JXG.isNumber(i)||JXG.isString(i))&&JXG.isArray(r)?[i+" - "+r[0],i+" - "+r[1]]:JXG.isArray(i)&&(JXG.isNumber(r)||JXG.isString(r))?[i[0]+" - "+r,i[1]+" - "+r]:i+" - "+r);case"neg":return"!("+a+")";case"pow":return"Math.pow("+a+", "+s+")";case"or":return"("+a+"||"+s+")";case"and":return"("+a+"&&"+s+")";case"mul":return JXG.GeogebraReader.isGGBVector(a)&&!JXG.isArray(s)?[1,"("+a[1]+")*"+s,"("+a[2]+")*"+s]:!JXG.isArray(a)&&JXG.GeogebraReader.isGGBVector(s)?[1,"("+s[1]+")*"+a,"("+s[2]+")*"+a]:JXG.GeogebraReader.isGGBVector(a)&&JXG.GeogebraReader.isGGBVector(s)?"(("+a[1]+")*("+s[1]+")+("+a[2]+")*("+s[2]+"))":(i=JXG.isString(a)&&!a.match(/JXG\.getRef\(JXG\.GeogebraReader\.board, "(.+?)"\)\./)&&a.match(/JXG\.getRef/)?[a+".X()",a+".Y()"]:a,r=JXG.isString(s)&&!s.match(/JXG\.getRef\(JXG\.GeogebraReader\.board, "(.+?)"\)\./)&&s.match(/JXG\.getRef/)?[s+".X()",s+".Y()"]:s,JXG.isArray(i)&&JXG.isArray(r)?[i[0]+" * "+r[0],i[1]+" * "+r[1]]:(JXG.isNumber(i)||JXG.isString(i))&&(JXG.isNumber(r)||JXG.isString(r))?i+" * "+r:(JXG.isNumber(i)||JXG.isString(i))&&JXG.isArray(r)?[i+" * "+r[0],i+" * "+r[1]]:JXG.isArray(i)&&(JXG.isNumber(r)||JXG.isString(r))?[i[0]+" * "+r,i[1]+" * "+r]:i+" * "+r);case"div":return i=JXG.isString(a)&&!a.match(/JXG\.getRef\(JXG\.GeogebraReader\.board, "(.+?)"\)\./)&&a.match(/JXG\.getRef/)?[a+".X()",a+".Y()"]:a,r=JXG.isString(s)&&!s.match(/JXG\.getRef\(JXG\.GeogebraReader\.board, "(.+?)"\)\./)&&s.match(/JXG\.getRef/)?[s+".X()",s+".Y()"]:s,JXG.isArray(i)&&JXG.isArray(r)?[i[0]+" / "+r[0],i[1]+" / "+r[1]]:(JXG.isNumber(i)||JXG.isString(i))&&(JXG.isNumber(r)||JXG.isString(r))?i+" / "+r:(JXG.isNumber(i)||JXG.isString(i))&&JXG.isArray(r)?[i+" / "+r[0],i+" / "+r[1]]:JXG.isArray(i)&&(JXG.isNumber(r)||JXG.isString(r))?[i[0]+" / "+r,i[1]+" / "+r]:i+" / "+r;case"negmult":return JXG.GeogebraReader.isGGBVector(a)?[1,"-1*"+a[1],"-1*"+a[2]]:"-1*"+a;case"bra":return JXG.GeogebraReader.isGGBVector(a)?[1,"("+a[1]+")","("+a[2]+")"]:"("+a+")";case"int":return parseInt(a);case"float":return parseFloat(a);case"param":return a;case"html":return a;case"string":return s?[a,s]:a;case"command":switch(s=a.split("["),i=s[0],r=s[1].split("]")[0],i.toLowerCase()){case"name":return'JXG.getRef(JXG.GeogebraReader.board, "'+r+'").getName()'}break;case"var":if(!s)return"PI"==a?"Math.PI":(o=JXG.GeogebraReader.checkElement(a),JXG.GeogebraReader.board.ggb[a]!==void 0?'JXG.GeogebraReader.board.ggb["'+a+'"]()':o.Value!==void 0?'JXG.getRef(JXG.GeogebraReader.board, "'+a+'").Value()':o.Area!==void 0?'JXG.getRef(JXG.GeogebraReader.board, "'+a+'").Area()':o.plaintextStr!==void 0?'1.0*JXG.getRef(JXG.GeogebraReader.board, "'+a+'").plaintextStr':o.type==JXG.OBJECT_TYPE_VECTOR?[1,'JXG.getRef(JXG.GeogebraReader.board, "'+a+'").point2.X()-JXG.getRef(JXG.GeogebraReader.board, "'+a+'").point1.X()','JXG.getRef(JXG.GeogebraReader.board, "'+a+'").point2.Y()-JXG.getRef(JXG.GeogebraReader.board, "'+a+'").point1.Y()']:o.elementClass==JXG.OBJECT_CLASS_LINE?'JXG.getRef(JXG.GeogebraReader.board, "'+a+'").point1.Dist(JXG.getRef(JXG.GeogebraReader.board, "'+a+'").point2)':'JXG.getRef(JXG.GeogebraReader.board, "'+a+'")');switch(a.toLowerCase()){case"x":return s+".X()";case"y":return s+".Y()";case"abs":case"acos":case"asin":case"atan":case"ceil":case"cos":case"exp":case"floor":case"log":case"max":case"min":case"pow":case"random":case"round":case"sin":case"sqrt":case"tan":return"Math."+a.toLowerCase()+"("+s+")";default:return a.toLowerCase()+"*("+s+")"}}},this.ggbParse=function(e,t){function n(e){a+=e+"\n"}function i(e){var t=0,n=-1,i=0,r=0,o=e.offset+1;do{if(o--,t=0,n=-2,r=o,r>=e.src.length)return 28;do{switch(t){case 0:t=9==e.src.charCodeAt(o)||32==e.src.charCodeAt(o)?1:33==e.src.charCodeAt(o)?2:40==e.src.charCodeAt(o)?3:41==e.src.charCodeAt(o)?4:42==e.src.charCodeAt(o)?5:43==e.src.charCodeAt(o)?6:44==e.src.charCodeAt(o)?7:45==e.src.charCodeAt(o)?8:47==e.src.charCodeAt(o)?9:e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)?10:60==e.src.charCodeAt(o)?11:62==e.src.charCodeAt(o)?12:e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?13:94==e.src.charCodeAt(o)?14:34==e.src.charCodeAt(o)?26:38==e.src.charCodeAt(o)?28:46==e.src.charCodeAt(o)?29:61==e.src.charCodeAt(o)?30:95==e.src.charCodeAt(o)?31:124==e.src.charCodeAt(o)?32:-1;break;case 1:t=-1,n=1,i=o;break;case 2:t=61==e.src.charCodeAt(o)?15:-1,n=23,i=o;break;case 3:t=-1,n=2,i=o;break;case 4:t=-1,n=3,i=o;break;case 5:t=-1,n=13,i=o;break;case 6:t=-1,n=11,i=o;break;case 7:t=-1,n=16,i=o;break;case 8:t=-1,n=12,i=o;break;case 9:t=-1,n=14,i=o;break;case 10:t=e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)?10:46==e.src.charCodeAt(o)?18:-1,n=4,i=o;break;case 11:t=61==e.src.charCodeAt(o)?19:-1,n=21,i=o;break;case 12:t=61==e.src.charCodeAt(o)?21:-1,n=22,i=o;break;case 13:t=e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?13:e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)?27:91==e.src.charCodeAt(o)?34:95==e.src.charCodeAt(o)?35:-1,n=7,i=o;break;case 14:t=-1,n=15,i=o;break;case 15:t=-1,n=20,i=o;break;case 16:t=-1,n=9,i=o;break;case 17:t=-1,n=25,i=o;break;case 18:t=e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)?18:-1,n=5,i=o;break;case 19:t=-1,n=17,i=o;break;case 20:t=-1,n=19,i=o;break;case 21:t=-1,n=18,i=o;break;case 22:t=-1,n=24,i=o;break;case 23:t=-1,n=8,i=o;break;case 24:t=e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?24:-1,n=6,i=o;break;case 25:t=-1,n=10,i=o;break;case 26:t=34==e.src.charCodeAt(o)?16:32==e.src.charCodeAt(o)||46==e.src.charCodeAt(o)||e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)||61==e.src.charCodeAt(o)||e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)||223==e.src.charCodeAt(o)||228==e.src.charCodeAt(o)||246==e.src.charCodeAt(o)||252==e.src.charCodeAt(o)?26:-1;break;case 27:t=e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?27:95==e.src.charCodeAt(o)?35:-1,n=7,i=o;break;case 28:t=38==e.src.charCodeAt(o)?17:e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?33:-1;break;case 29:t=e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)?18:-1;break;case 30:t=61==e.src.charCodeAt(o)?20:-1;break;case 31:t=95==e.src.charCodeAt(o)?36:-1;break;case 32:t=124==e.src.charCodeAt(o)?22:-1;break;case 33:t=59==e.src.charCodeAt(o)?23:e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?33:-1;break;case 34:t=e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?37:-1;break;case 35:t=e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?27:95==e.src.charCodeAt(o)?35:-1;break;case 36:t=e.src.charCodeAt(o)>=48&&57>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?24:-1;break;case 37:t=93==e.src.charCodeAt(o)?25:e.src.charCodeAt(o)>=65&&90>=e.src.charCodeAt(o)||e.src.charCodeAt(o)>=97&&122>=e.src.charCodeAt(o)?37:-1}o++}while(t>-1)}while(1==n);return n>-1?(e.att=e.src.substr(r,i-r),e.offset=i):(e.att=new String,n=-1),n}function r(e,r,s){var l,c,d,h,p=[],f=[],g=0,m=Function("","var offset; var src; var att;"),v=new m,b=[[0,1],[27,1],[26,5],[26,3],[26,3],[26,3],[26,3],[26,3],[26,3],[26,3],[26,3],[26,2],[26,3],[26,3],[26,3],[26,3],[26,3],[26,2],[26,3],[26,3],[26,1],[26,1],[26,1],[26,1],[26,1],[26,1],[26,4],[26,1]],y=[[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[28,0],[14,13,13,14,25,15,24,16,15,17,12,18,11,19,22,20,21,21,20,22,19,23,18,24,17,25,28,-1],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[11,29,28,-24,17,-24,18,-24,19,-24,20,-24,21,-24,22,-24,12,-24,15,-24,24,-24,25,-24,13,-24,14,-24,16,-24,3,-24],[28,-20,17,-20,18,-20,19,-20,20,-20,21,-20,22,-20,11,-20,12,-20,15,-20,24,-20,25,-20,13,-20,14,-20,16,-20,3,-20],[28,-21,17,-21,18,-21,19,-21,20,-21,21,-21,22,-21,11,-21,12,-21,15,-21,24,-21,25,-21,13,-21,14,-21,16,-21,3,-21],[28,-22,17,-22,18,-22,19,-22,20,-22,21,-22,22,-22,11,-22,12,-22,15,-22,24,-22,25,-22,13,-22,14,-22,16,-22,3,-22],[28,-23,17,-23,18,-23,19,-23,20,-23,21,-23,22,-23,11,-23,12,-23,15,-23,24,-23,25,-23,13,-23,14,-23,16,-23,3,-23],[28,-25,17,-25,18,-25,19,-25,20,-25,21,-25,22,-25,11,-25,12,-25,15,-25,24,-25,25,-25,13,-25,14,-25,16,-25,3,-25],[2,30,28,-27,17,-27,18,-27,19,-27,20,-27,21,-27,22,-27,11,-27,12,-27,15,-27,24,-27,25,-27,13,-27,14,-27,16,-27,3,-27],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[14,13,13,14,25,15,24,16,15,17,12,18,11,19,22,20,21,21,20,22,19,23,18,24,17,25,16,44,3,45],[14,-11,13,-11,25,15,24,16,15,-11,12,-11,11,-11,22,-11,21,-11,20,-11,19,-11,18,-11,17,-11,28,-11,16,-11,3,-11],[14,-17,13,-17,25,15,24,16,15,17,12,-17,11,-17,22,20,21,21,20,22,19,23,18,24,17,25,28,-17,16,-17,3,-17],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[14,-16,13,-16,25,15,24,16,15,17,12,-16,11,-16,22,20,21,21,20,22,19,23,18,24,17,25,28,-16,16,-16,3,-16],[14,-15,13,-15,25,15,24,16,15,17,12,-15,11,-15,22,20,21,21,20,22,19,23,18,24,17,25,28,-15,16,-15,3,-15],[14,-14,13,-14,25,-14,24,-14,15,-14,12,-14,11,-14,22,-14,21,-14,20,-14,19,-14,18,-14,17,-14,28,-14,16,-14,3,-14],[14,-13,13,-13,25,-13,24,-13,15,-13,12,-13,11,-13,22,-13,21,-13,20,-13,19,-13,18,-13,17,-13,28,-13,16,-13,3,-13],[14,-12,13,-12,25,15,24,16,15,-12,12,-12,11,-12,22,20,21,21,20,22,19,23,18,24,17,25,28,-12,16,-12,3,-12],[14,13,13,14,25,15,24,16,15,17,12,-10,11,-10,22,20,21,21,20,22,19,23,18,24,17,25,28,-10,16,-10,3,-10],[14,13,13,14,25,15,24,16,15,17,12,-9,11,-9,22,20,21,21,20,22,19,23,18,24,17,25,28,-9,16,-9,3,-9],[14,-8,13,-8,25,15,24,16,15,-8,12,-8,11,-8,22,-8,21,-8,20,-8,19,-8,18,-8,17,-8,28,-8,16,-8,3,-8],[14,-7,13,-7,25,15,24,16,15,-7,12,-7,11,-7,22,-7,21,-7,20,-7,19,-7,18,-7,17,-7,28,-7,16,-7,3,-7],[14,-6,13,-6,25,15,24,16,15,-6,12,-6,11,-6,22,-6,21,-6,20,-6,19,-6,18,-6,17,-6,28,-6,16,-6,3,-6],[14,-5,13,-5,25,15,24,16,15,-5,12,-5,11,-5,22,-5,21,-5,20,-5,19,-5,18,-5,17,-5,28,-5,16,-5,3,-5],[14,-4,13,-4,25,15,24,16,15,-4,12,-4,11,-4,22,-4,21,-4,20,-4,19,-4,18,-4,17,-4,28,-4,16,-4,3,-4],[14,-3,13,-3,25,15,24,16,15,-3,12,-3,11,-3,22,-3,21,-3,20,-3,19,-3,18,-3,17,-3,28,-3,16,-3,3,-3],[2,3,23,4,12,5,9,6,4,7,5,8,6,9,8,10,10,11,7,12],[28,-18,17,-18,18,-18,19,-18,20,-18,21,-18,22,-18,11,-18,12,-18,15,-18,24,-18,25,-18,13,-18,14,-18,16,-18,3,-18],[14,13,13,14,25,15,24,16,15,17,12,-19,11,-19,22,20,21,21,20,22,19,23,18,24,17,25,28,-19,16,-19,3,-19],[14,13,13,14,25,15,24,16,15,17,12,18,11,19,22,20,21,21,20,22,19,23,18,24,17,25,3,49],[14,13,13,14,25,15,24,16,15,17,12,18,11,19,22,20,21,21,20,22,19,23,18,24,17,25,3,50],[28,-26,17,-26,18,-26,19,-26,20,-26,21,-26,22,-26,11,-26,12,-26,15,-26,24,-26,25,-26,13,-26,14,-26,16,-26,3,-26],[28,-2,17,-2,18,-2,19,-2,20,-2,21,-2,22,-2,11,-2,12,-2,15,-2,24,-2,25,-2,13,-2,14,-2,16,-2,3,-2]],x=[[27,1,26,2],[],[],[26,26],[26,27],[26,28],[],[],[],[],[],[],[],[26,31],[26,32],[26,33],[26,34],[26,35],[26,36],[26,37],[26,38],[26,39],[26,40],[26,41],[26,42],[26,43],[],[],[],[26,46],[26,47],[],[],[],[],[],[],[],[],[],[],[],[],[],[26,48],[],[],[],[],[],[]],w=["p'","WHITESPACE","(",")","INT","FLOAT","PARAM","VAR","HTML","STRING","COMMAND","+","-","*","/","^",",","<=",">=","==","!=","<",">","!","||","&&","e","p","$"];for(v.offset=0,v.src=e,v.att=new String,r||(r=[]),s||(s=[]),p.push(0),f.push(0),d=i(v);;){l=52;for(var k=0;y[p[p.length-1]].length>k;k+=2)if(y[p[p.length-1]][k]==d){l=y[p[p.length-1]][k+1];break}if(o&&p.length>0&&n("\nState "+p[p.length-1]+"\n"+"	Lookahead: "+w[d]+' ("'+v.att+'")\n'+"	Action: "+l+"\n"+'	Source: "'+v.src.substr(v.offset,30)+(v.offset+30<v.src.length?"...":"")+'"\n'+"	Stack: "+p.join()+"\n"+"	Value stack: "+f.join()+"\n"),52==l){o&&n("Error detected: There is no reduce or shift on the symbol "+w[d]),g++,r.push(v.offset-v.att.length),s.push([]);for(var k=0;y[p[p.length-1]].length>k;k+=2)s[s.length-1].push(w[y[p[p.length-1]][k]]);for(var C=[],_=[],k=0;p.length>k;k++)C[k]=p[k],_[k]=f[k];for(;52==l&&28!=d;){for(o&&n("	Error recovery\nCurrent lookahead: "+w[d]+" ("+v.att+")\n"+"Action: "+l+"\n\n"),-1==d&&v.offset++;52==l&&p.length>0&&(p.pop(),f.pop(),0!=p.length);){l=52;for(var k=0;y[p[p.length-1]].length>k;k+=2)if(y[p[p.length-1]][k]==d){l=y[p[p.length-1]][k+1];break}}if(52!=l)break;for(var k=0;C.length>k;k++)p.push(C[k]),f.push(_[k]);d=i(v)}if(52==l){o&&n("	Error recovery failed, terminating parse process...");break}o&&n("	Error recovery succeeded, continuing")}if(l>0)o&&n("Shifting symbol: "+w[d]+" ("+v.att+")"),p.push(l),f.push(v.att),d=i(v),o&&n("	New lookahead symbol: "+w[d]+" ("+v.att+")");else{switch(l*=-1,o&&n("Reducing by producution: "+l),h=void 0,o&&n("	Performing semantic action..."),l){case 0:h=f[f.length-1];break;case 1:h=JXG.GeogebraReader.ggbAct("end",f[f.length-1]);break;case 2:h=JXG.GeogebraReader.ggbAct("coord",f[f.length-4],f[f.length-2],t);break;case 3:h=JXG.GeogebraReader.ggbAct("le",f[f.length-3],f[f.length-1]);break;case 4:h=JXG.GeogebraReader.ggbAct("ge",f[f.length-3],f[f.length-1]);break;case 5:h=JXG.GeogebraReader.ggbAct("eq",f[f.length-3],f[f.length-1]);break;case 6:h=JXG.GeogebraReader.ggbAct("neq",f[f.length-3],f[f.length-1]);break;case 7:h=JXG.GeogebraReader.ggbAct("lt",f[f.length-3],f[f.length-1]);break;case 8:h=JXG.GeogebraReader.ggbAct("gt",f[f.length-3],f[f.length-1]);break;case 9:h=JXG.GeogebraReader.ggbAct("add",f[f.length-3],f[f.length-1]);break;case 10:h=JXG.GeogebraReader.ggbAct("sub",f[f.length-3],f[f.length-1]);break;case 11:h=JXG.GeogebraReader.ggbAct("neg",f[f.length-1]);break;case 12:h=JXG.GeogebraReader.ggbAct("pow",f[f.length-3],f[f.length-1]);break;case 13:h=JXG.GeogebraReader.ggbAct("or",f[f.length-3],f[f.length-1]);break;case 14:h=JXG.GeogebraReader.ggbAct("and",f[f.length-3],f[f.length-1]);break;case 15:h=JXG.GeogebraReader.ggbAct("mul",f[f.length-3],f[f.length-1]);break;case 16:h=JXG.GeogebraReader.ggbAct("div",f[f.length-3],f[f.length-1]);break;case 17:h=JXG.GeogebraReader.ggbAct("negmult",f[f.length-1]);break;case 18:h=JXG.GeogebraReader.ggbAct("bra",f[f.length-2]);break;case 19:h=JXG.GeogebraReader.ggbAct("string",f[f.length-3],f[f.length-1]);break;case 20:h=JXG.GeogebraReader.ggbAct("int",f[f.length-1]);break;case 21:h=JXG.GeogebraReader.ggbAct("float",f[f.length-1]);break;case 22:h=JXG.GeogebraReader.ggbAct("param",f[f.length-1]);break;case 23:h=JXG.GeogebraReader.ggbAct("html",f[f.length-1]);break;case 24:h=JXG.GeogebraReader.ggbAct("string",f[f.length-1]);break;case 25:h=JXG.GeogebraReader.ggbAct("command",f[f.length-1]);break;case 26:h=JXG.GeogebraReader.ggbAct("var",f[f.length-4],f[f.length-2]);break;case 27:h=JXG.GeogebraReader.ggbAct("var",f[f.length-1])}o&&n("	Popping "+b[l][1]+" off the stack...");for(var k=0;b[l][1]>k;k++)p.pop(),u=f.pop();c=-1;for(var k=0;x[p[p.length-1]].length>k;k+=2)if(x[p[p.length-1]][k]==b[l][0]){c=x[p[p.length-1]][k+1];break}if(0==l)break;o&&n("	Pushing non-terminal "+w[b[l][0]]),p.push(c),f.push(h)}o&&(JXG.debug(a),a=new String)}return o&&(n("\nParse complete."),JXG.debug(a)),g}var t=t?JXG.getRef(JXG.GeogebraReader.board,JXG.GeogebraReader.board.ggbElements[t].id):!1;t&&JXG.debug("Zu aktualisierendes Element: "+t.name+"("+t.id+")");var o=!1,a=new String,s=[],l=[],c=0,u=e;if((c=r(u,s,l))>0){for(var d=new String,h=0;c>h;h++)d+="Parse error in line "+(u.substr(0,s[h]).match(/\n/g)?u.substr(0,s[h]).match(/\n/g).length:1)+' near "'+u.substr(s[h])+'", expecting "'+l[h].join()+'"\n';JXG.debug(d)}return u},this.setDefaultOptions=function(e){return e.options.elements.strokeWidth="1px",e.options.elements.withLabel=!0,e.options.point.face="circle",e.options.point.size=3,e.options.point.fillColor="blue",e.options.point.fillOpacity=1,e.options.point.highlightFillOpacity=1,e.options.point.strokeColor="black",e.options.point.highlightStrokeColor="black",e.options.point.strokeWidth="2px",e.options.line.strokeWidth="1px",e.options.line.highlightStrokeColor="#000000",e.options.line.strokeColor="#000000",e.options.polygon.fillColor=JXG.rgb2hex(153,51,0),e.options.polygon.fillOpacity=.1,e.options.polygon.highlightFillColor=e.options.polygon.fillColor,e.options.polygon.highlightFillOpacity=.1,e.options.sector.fillColor=JXG.rgb2hex(153,51,0),e.options.sector.fillOpacity=.1,e.options.sector.highlightFillColor=e.options.sector.fillColor,e.options.sector.highlightFillOpacity=.1,e.options.angle.fillColor=JXG.rgb2hex(0,100,0),e.options.angle.fillOpacity=.1,e.options.angle.highlightFillOpacity=.1,e},this.colorProperties=function(e,t){var n,i,r,o;return n=e.getElementsByTagName("objColor").length>0&&e.getElementsByTagName("objColor")[0].getAttribute("alpha")?parseFloat(e.getElementsByTagName("objColor")[0].getAttribute("alpha")):0,i=e.getElementsByTagName("objColor").length>0&&e.getElementsByTagName("objColor")[0].getAttribute("r")?parseInt(e.getElementsByTagName("objColor")[0].getAttribute("r")).toString(16):0,r=e.getElementsByTagName("objColor").length>0&&e.getElementsByTagName("objColor")[0].getAttribute("g")?parseInt(e.getElementsByTagName("objColor")[0].getAttribute("g")).toString(16):0,o=e.getElementsByTagName("objColor").length>0&&e.getElementsByTagName("objColor")[0].getAttribute("b")?parseInt(e.getElementsByTagName("objColor")[0].getAttribute("b")).toString(16):0,1==i.length&&(i="0"+i),1==r.length&&(r="0"+r),1==o.length&&(o="0"+o),t.fillColor="#"+i+r+o,t.strokeColor=t.fillColor,t.highlightFillColor=t.fillColor,t.highlightStrokeColor=t.strokeColor,t.fillOpacity=n,t.highlightFillOpacity=n,t.labelColor=t.fillColor,t},this.boardProperties=function(e,t,n){return n},this.coordinates=function(e,t){var n,i={};if(i.x=0,i.y=0,i.z=0,t.getElementsByTagName("labelOffset")[0]&&(i.x=parseFloat(t.getElementsByTagName("labelOffset")[0].getAttribute("x"))/JXG.GeogebraReader.board.unitX,i.y=parseFloat(t.getElementsByTagName("labelOffset")[0].getAttribute("y"))/JXG.GeogebraReader.board.unitY),t.getElementsByTagName("coords")[0])e.x=parseFloat(t.getElementsByTagName("coords")[0].getAttribute("x")),e.y=parseFloat(t.getElementsByTagName("coords")[0].getAttribute("y")),e.z=parseFloat(t.getElementsByTagName("coords")[0].getAttribute("z"));else if(t.getElementsByTagName("startPoint")[0])if(t.getElementsByTagName("startPoint")[0].getAttribute("exp")){var r=JXG.getRef(JXG.GeogebraReader.board,t.getElementsByTagName("startPoint")[0].getAttribute("exp"));e.x=function(){return r.X()+i.x},e.y=function(){return r.Y()-i.y},e.z=!1}else e.x=parseFloat(t.getElementsByTagName("startPoint")[0].getAttribute("x")),e.y=parseFloat(t.getElementsByTagName("startPoint")[0].getAttribute("y")),e.z=parseFloat(t.getElementsByTagName("startPoint")[0].getAttribute("z"));else{if(!t.getElementsByTagName("absoluteScreenLocation")[0])return!1;var n=new JXG.Coords(JXG.COORDS_BY_SCREEN,[parseFloat(t.getElementsByTagName("absoluteScreenLocation")[0].getAttribute("x")),parseFloat(t.getElementsByTagName("absoluteScreenLocation")[0].getAttribute("y"))],JXG.GeogebraReader.board);e.x=n.usrCoords[1]+i.x,e.y=n.usrCoords[2]+i.y,e.z=!1}return e},this.visualProperties=function(e,t){return 0!=e.getElementsByTagName("show").length&&e.getElementsByTagName("show")[0].getAttribute("object")?t.visible=e.getElementsByTagName("show")[0].getAttribute("object"):!1,0!=e.getElementsByTagName("show").length&&e.getElementsByTagName("show")[0].getAttribute("label")?t.withLabel=e.getElementsByTagName("show")[0].getAttribute("label"):!0,"true"==t.withLabel?t.withLabel=!0:"false"==t.withLabel&&(t.withLabel=!1),e.getElementsByTagName("pointSize")[0]?t.size=e.getElementsByTagName("pointSize")[0].getAttribute("val"):!1,e.getElementsByTagName("pointStyle")[0]?t.styleGGB=e.getElementsByTagName("pointStyle")[0].getAttribute("val"):!1,0==t.styleGGB||2==t.styleGGB?(t.face="circle",0==t.styleGGB?(t.fillColor=t.strokeColor,t.fillOpacity=1,t.highlightFillColor=t.strokeColor,t.highlightFillOpacity=1,t.strokeColor="black",t.strokeWidth="1px"):2==t.styleGGB&&(t.fillColor="none")):1==t.styleGGB?t.face="x":3==t.styleGGB?(t.face="+",t.strokeOpacity=1):4==t.styleGGB||5==t.styleGGB?(t.face="diamond",4==t.styleGGB?(t.fillColor=t.strokeColor,t.fillOpacity=1):5==t.styleGGB&&(t.fillColor="none")):6==t.styleGGB?(t.face="triangleUp",t.fillColor=t.strokeColor,t.fillOpacity=1):7==t.styleGGB?(t.face="triangleDown",t.fillColor=t.strokeColor,t.fillOpacity=1):8==t.styleGGB?(t.face="triangleRight",t.fillColor=t.strokeColor,t.fillOpacity=1):9==t.styleGGB&&(t.face="triangleLeft",t.fillColor=t.strokeColor,t.fillOpacity=1),e.getElementsByTagName("slopeTriangleSize")[0]?t.slopeWidth=e.getElementsByTagName("slopeTriangleSize")[0].getAttribute("val"):!1,e.getElementsByTagName("lineStyle")[0]?t.strokeWidth=e.getElementsByTagName("lineStyle")[0].getAttribute("thickness")/2+"px":!1,t.strokeWidth&&(t.highlightStrokeWidth=1*t.strokeWidth.substr(0,t.strokeWidth.length-2)+1+"px"),e.getElementsByTagName("lineStyle")[0]?t.dashGGB=e.getElementsByTagName("lineStyle")[0].getAttribute("type"):!1,0==t.dashGGB?t.dash=0:10==t.dashGGB?t.dash=2:15==t.dashGGB?t.dash=3:20==t.dashGGB?t.dash=1:30==t.dashGGB&&(t.dash=6),e.getElementsByTagName("labelOffset")[0]?t.labelX=1*e.getElementsByTagName("labelOffset")[0].getAttribute("x"):!1,e.getElementsByTagName("labelOffset")[0]?t.labelY=1*e.getElementsByTagName("labelOffset")[0].getAttribute("y"):!1,e.getElementsByTagName("trace")[0]?t.trace=e.getElementsByTagName("trace")[0].getAttribute("val"):!1,e.getElementsByTagName("fix")[0]?t.fixed=e.getElementsByTagName("fix")[0].getAttribute("val"):!1,t},this.getElement=function(e,t){var n,i,r;for(t=t||!1,i=0;JXG.GeogebraReader.tree.getElementsByTagName("construction").length>i;i++)if(0==t){for(r=0;JXG.GeogebraReader.tree.getElementsByTagName("construction")[i].getElementsByTagName("element").length>r;r++)if(n=JXG.GeogebraReader.tree.getElementsByTagName("construction")[i].getElementsByTagName("element")[r],e==n.getAttribute("label"))return n}else for(r=0;JXG.GeogebraReader.tree.getElementsByTagName("construction")[i].getElementsByTagName("expression").length>r;r++)if(n=JXG.GeogebraReader.tree.getElementsByTagName("construction")[i].getElementsByTagName("expression")[r],e==n.getAttribute("label"))return n;return!1},this.checkElement=function(e){if(JXG.GeogebraReader.board.ggbElements[e]===void 0||""==JXG.GeogebraReader.board.ggbElements[e]){var t=JXG.GeogebraReader.getElement(e);JXG.GeogebraReader.board.ggbElements[e]=JXG.GeogebraReader.writeElement(JXG.GeogebraReader.board,t)}return JXG.GeogebraReader.board.ggbElements[e]},this.functionParse=function(type,exp){var input,vars,expr,output,i,s,o;switch(type){case"c":if(exp.match(/[a-zA-Z0-9\']+\([a-zA-Z0-9]+[a-zA-Z0-9,\ ]*\)[\ ]*[=][\ ]*[a-zA-Z0-9\+\-\*\/ \( \) \u005E]+/)){for(input=exp.split("(")[1].split(")")[0],vars=input.split(", "),output=[],i=0;vars.length>i;i++)output.push("__"+vars[i]);for(expr=exp.split("=")[1],i=0;vars.length>i;i++)expr="x"==vars[i]?expr.replace(/(?![e])x(?!\()(?![p])/g,"__"+vars[i]):"y"==vars[i]?expr.replace(/(?![e])y(?!\()(?![p])/g,"__"+vars[i]):expr.replace(eval("/"+vars[i]+"/g"),"__"+vars[i]);if(expr=expr.replace(/-__/g,"-1*__"),3.01>=JXG.GeogebraReader.format){s=expr.split(" "),o="";for(var i=0;s.length>i;i++)s.length!=i+1&&(s[i].search(/\)$/)>-1||s[i].search(/[0-9]+$/)>-1||s[i].search(/[a-zA-Z]+(\_*[a-zA-Z0-9]+)*$/)>-1)&&(s[i+1].search(/^\(/)>-1||s[i+1].search(/^[0-9]+/)>-1||s[i+1].search(/^[a-zA-Z]+(\_*[a-zA-Z0-9]+)*/)>-1||s[i+1].search(/\_\_[a-zA-Z0-9]+/)>-1)&&(s[i]=s[i]+"*"),o+=s[i];expr=o}return output.push(expr),output}return exp;case"s":return exp=exp.replace(/(?![e])x(?!\()(?![p])/g,"__x"),["__x",exp];default:if(3.01>=JXG.GeogebraReader.format){for(s=exp.split(" "),o="",i=0;s.length>i;i++)s.length!=i+1&&(s[i].search(/\)$/)>-1||s[i].search(/[0-9]+$/)>-1||s[i].search(/[a-zA-Z]+(\_*[a-zA-Z0-9]+)*$/)>-1)&&(s[i+1].search(/^\(/)>-1||s[i+1].search(/^[0-9]+/)>-1||s[i+1].search(/^[a-zA-Z]+(\_*[a-zA-Z0-9]+)*/)>-1||s[i+1].search(/\_\_[a-zA-Z0-9]+/)>-1)&&(s[i]=s[i]+"*"),o+=s[i];exp=o}return exp}},this.writeBoard=function(e){var t=JXG.GeogebraReader.tree.getElementsByTagName("euclidianView")[0];e.origin={},e.origin.usrCoords=[1,0,0],e.origin.scrCoords=[1,1*t.getElementsByTagName("coordSystem")[0].getAttribute("xZero"),1*t.getElementsByTagName("coordSystem")[0].getAttribute("yZero")],e.unitX=t.getElementsByTagName("coordSystem")[0].getAttribute("scale")?1*t.getElementsByTagName("coordSystem")[0].getAttribute("scale"):1,e.unitY=t.getElementsByTagName("coordSystem")[0].getAttribute("yscale")?1*t.getElementsByTagName("coordSystem")[0].getAttribute("yscale"):e.unitX,e.fontSize=JXG.GeogebraReader.tree.getElementsByTagName("gui")[0]&&JXG.GeogebraReader.tree.getElementsByTagName("gui")[0].getElementsByTagName("font")[0]?1*JXG.GeogebraReader.tree.getElementsByTagName("gui")[0].getElementsByTagName("font")[0].getAttribute("size"):"12px",JXG.JSXGraph.boards[e.id]=e,e.renderer.enhancedRendering=!0,"true"==t.getElementsByTagName("evSettings")[0].getAttribute("pointCapturing"),"true"==t.getElementsByTagName("evSettings")[0].getAttribute("grid")?e.create("grid"):null,t.getElementsByTagName("evSettings")[0].getAttribute("axes")&&"true"==t.getElementsByTagName("evSettings")[0].getAttribute("axes")&&(e.ggbElements.xAxis=e.create("axis",[[0,0],[1,0]],{strokeColor:"black",minorTicks:0}),e.ggbElements.yAxis=e.create("axis",[[0,0],[0,1]],{strokeColor:"black",minorTicks:0}))},this.writeElement=function(e,t,n,i){var r,o,a,s,l,c,u,d,h,p,f,g,m,v,b,y,x,w;switch(r=JXG.isArray(t)?t[0]:t,o={},a={},JXG.debug(r),o.type=r&&r.attributes&&i===void 0?r.getAttribute("type").toLowerCase():i,o.label=r.getAttribute("label"),a.name=o.label,JXG.debug("<br><b>Konstruiere</b> "+a.name+"("+o.type+"):"),o.type){case"point":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),a=JXG.GeogebraReader.visualProperties(r,a),JXG.GeogebraReader.getElement(a.name,!0)?(l=JXG.GeogebraReader.getElement(a.name,!0).getAttribute("exp"),c=JXG.GeogebraReader.ggbParse(l),o.x=Function("return "+c[0]+";"),o.y=Function("return "+c[1]+";")):o=JXG.GeogebraReader.coordinates(o,r),JXG.exists(a.styleGGB)||(a.face="circle",a.fillColor=a.strokeColor,a.fillOpacity=1,a.highlightFillColor=a.strokeColor,a.highlightFillOpacity=1,a.strokeColor="black",a.strokeWidth="1px"),JXG.debug(o),JXG.debug(n);try{var k=/Circle\[\s*(\w+)\s*,\s*([\d\.]+)\s*\]/.exec(n);if(n!==void 0)if(null!=k&&3==k.length){var C=JXG.GeogebraReader.checkElement(k[1]),_=e.create("circle",[C,parseFloat(k[2])],{fillColor:"none",visible:!1,name:""});s=e.create("glider",[o.x,o.y,_],a)}else s=JXG.isArray(n)?e.create("glider",[o.x,o.y,n[0]],a):e.create("glider",[o.x,o.y,n],a);else s=e.create("point",[o.x,o.y],a);return s}catch(g){return JXG.debug("* <b>Err:</b> Point "+a.name+"<br>\n"),!1}break;case"segment":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Segment:</b> ("+a.name+") First: "+n[0].name+", Last: "+n[1].name+"<br>\n"),a.straightFirst=!1,a.straightLast=!1,s=e.create("line",n,a)}catch(g){return JXG.debug("* <b>Err:</b> Segment "+a.name+" First: "+n[0].name+", Last: "+n[1].name+"<br>\n"),!1}break;case"line":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a),u="line",n?JXG.getRef(e,n[1].id).elementClass==JXG.OBJECT_CLASS_LINE&&(u="parallel"):n=[parseFloat(r.getElementsByTagName("coords")[0].getAttribute("z")),parseFloat(r.getElementsByTagName("coords")[0].getAttribute("x")),parseFloat(r.getElementsByTagName("coords")[0].getAttribute("y"))];try{return s=e.create(u,n,a)}catch(g){return JXG.debug("* <b>Err:</b> Line "+a.label+"<br>\n"),!1}break;case"orthogonalline":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Orthogonalline:</b> First: "+n[0].id+", Last: "+n[1].id+"<br>\n"),s=e.create("normal",n,a)}catch(g){return JXG.debug("* <b>Err:</b> Orthogonalline "+a.label+"<br>\n"),!1}break;case"polygon":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a),3==n.length&&4!=t.length&&(n[2]=parseInt(n[2]),u="regular");try{JXG.debug("* <b>Polygon:</b> First: "+n[0].name+", Second: "+n[1].name+", Third: "+n[2]+"<br>\n");var T=[],E=[];h="regular"==u?t.length-n[2]+2:t.length;for(var S=1;h>S;S++)T[S-1]={},E[S-1]={},T[S-1].id="",T[S-1].name=t[S].getAttribute("label"),E[S-1]=JXG.GeogebraReader.colorProperties(t[S],E[S-1]),E[S-1]=JXG.GeogebraReader.visualProperties(t[S],E[S-1]);if(a.borders=T,d=[],"regular"==u)for(d.push(n[0]),d.push(n[1]),S=n[2]+1;t.length>S;S++)t[S].attributes?d.push(JXG.GeogebraReader.checkElement(t[S].getAttribute("label"))):d.push(t[S]);else for(S=0;n.length>S;S++)"object"==typeof n[S]&&d.push(n[S]);for(s="regular"==u?e.create("regularpolygon",d,a):e.create("polygon",d,a),S=0;s.borders.length>S;S++)E[S].withLabel&&s.borders[S].createLabel(),s.borders[S].setProperty(E[S]);
return s}catch(g){return JXG.debug("* <b>Err:</b> Polygon "+a.name+"<br>\n"),!1}break;case"intersect":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{if(JXG.debug("* <b>Intersection:</b> First: "+n[0].name+", Second: "+n[1].name+"<br>\n"),JXG.exists(a.styleGGB)||(a.face="circle",a.fillColor=a.strokeColor,a.fillOpacity=1,a.highlightFillColor=a.strokeColor,a.highlightFillOpacity=1,a.strokeColor="black",a.strokeWidth="1px"),1==t.length)s=e.create("intersection",[n[0],n[1],0],a);else{s=e.create("intersection",[n[0],n[1],1],a);var A={};A=JXG.GeogebraReader.colorProperties(t[1],A),A=JXG.GeogebraReader.visualProperties(t[1],A),A.name=t[1].getAttribute("label");var I=e.create("otherintersection",[n[0],n[1],s],A);e.ggbElements[A.name]=I}return s}catch(g){return JXG.debug("* <b>Err:</b> Intersection "+a.name+"<br>\n"),!1}break;case"distance":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Distance:</b> First: "+n[0].name+", Second: "+n[1].name+"<br>\n"),p=e.create("midpoint",n,{visible:"false"}),a.visible="true",s=e.create("text",[function(){return p.X()},function(){return p.Y()},function(){return"<span style='text-decoration: overline'>"+n[0].name+n[1].name+"</span> = "+JXG.trimNumber(JXG.getRef(e,n[0].id).Dist(JXG.getRef(e,n[1].id)).toFixed(JXG.GeogebraReader.decimals))}],a),s.Value=function(){return JXG.getRef(e,n[0].id).Dist(JXG.getRef(e,n[1].id))},s}catch(g){return JXG.debug("* <b>Err:</b> Distance "+a.name+"<br>\n"),!1}break;case"vector":if(a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a),r.getElementsByTagName("startPoint")[0]){if(g=n&&2==n.length?JXG.GeogebraReader.checkElement(n[1].name):[parseFloat(r.getElementsByTagName("coords")[0].getAttribute("x")),parseFloat(r.getElementsByTagName("coords")[0].getAttribute("y"))],r.getElementsByTagName("startPoint")[0].getAttribute("x")&&r.getElementsByTagName("startPoint")[0].getAttribute("y"))f=[parseFloat(r.getElementsByTagName("startPoint")[0].getAttribute("x")),parseFloat(r.getElementsByTagName("startPoint")[0].getAttribute("y"))];else if(r.getElementsByTagName("startPoint")[0].getAttribute("exp")){var O=r.getElementsByTagName("startPoint")[0].getAttribute("exp");f=JXG.GeogebraReader.checkElement(O)}}else if(n&&0!=n.length)f=n[0],g=n[1];else if(l=JXG.GeogebraReader.getElement(r.getAttribute("label"),!0))return l=l.getAttribute("exp"),l=JXG.GeogebraReader.ggbParse(l),l=JXG.isArray(l)?[Function("return "+l[1]+";"),Function("return "+l[2]+";")]:Function("return "+l+";"),JXG.debug("exp: "+l),s=e.create("arrow",[[0,0],[l[0],l[1]]],a);try{return JXG.debug("* <b>Vector:</b> First: "+a.name),s=e.create("arrow",[f,g],a)}catch(g){return JXG.debug("* <b>Err:</b> Vector "+a.name+g+"<br>\n"),!1}break;case"rotate":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Rotate:</b> First: "+n[0].name+", Second: "+n[1]+"<br>\n"),a.type="rotate",JXG.exists(a.styleGGB)||(a.face="circle",a.fillColor=a.strokeColor,a.fillOpacity=1,a.highlightFillColor=a.strokeColor,a.highlightFillOpacity=1,a.strokeColor="black",a.strokeWidth="1px"),$=e.create("transform",[parseInt(n[1])*Math.PI/180,n[2]],{type:"rotate"}),s=e.create("point",[n[0],$],a)}catch(g){return JXG.debug("* <b>Err:</b> Rotate "+a.name+"<br>\n"),!1}break;case"dilate":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{JXG.debug("* <b>Dilate:</b> First: "+n[0].name+", Second: "+n[1]+"<br>\n"),a.type="rotate";var R=parseInt(n[1]),L=e.create("transform",[R,R],{type:"scale"}),D=e.create("transform",[function(){return(1-R)*n[2].X()},function(){return(1-R)*n[2].Y()}],{type:"translate"});return JXG.exists(a.styleGGB)||(a.face="circle",a.fillColor=a.strokeColor,a.fillOpacity=1,a.highlightFillColor=a.strokeColor,a.highlightFillOpacity=1,a.strokeColor="black",a.strokeWidth="1px"),s=e.create("point",[n[0],[L,D]],a)}catch(g){return JXG.debug("* <b>Err:</b> Dilate "+a.name+"<br>\n"),!1}break;case"translate":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return $=e.create("transform",[function(){return n[1].point2.X()-n[1].point1.X()},function(){return n[1].point2.Y()-n[1].point1.Y()}],{type:"translate"}),JXG.exists(a.styleGGB)||(a.face="circle",a.fillColor=a.strokeColor,a.fillOpacity=1,a.highlightFillColor=a.strokeColor,a.highlightFillOpacity=1,a.strokeColor="black",a.strokeWidth="1px"),s=e.create("point",[n[0],$],a)}catch(g){return JXG.debug("* <b>Err:</b> Translate "+a.name+"<br>\n"),!1}break;case"mirror":if(a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a),JXG.isPoint(JXG.getRef(e,n[1].id)))var u="mirrorpoint";else if(JXG.getRef(e,n[1].id).elementClass==JXG.OBJECT_CLASS_LINE)var u="reflection";try{return JXG.debug("* <b>Mirror:</b> First: "+n[0].name+", Second: "+n[1].name+"<br>\n"),s=e.create(u,[n[1],n[0]],a)}catch(g){return JXG.debug("* <b>Err:</b> Mirror "+a.name+"<br>\n"),!1}break;case"circle":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Circle:</b> First: "+n[0].name+", Second: "+n[1]+"<br>\n"),s=e.create("circle",n,a)}catch(g){return JXG.debug("* <b>Err:</b> Circle "+a.name+"<br>\n"),!1}break;case"circlearc":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>CircleArc:</b> First: "+n[0].name+", Second: "+n[1].name+"<br>\n"),s=e.create("arc",n,a)}catch(g){return JXG.debug("* <b>Err:</b> CircleArc "+a.name+"<br>\n"),!1}break;case"ellipse":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Ellipse:</b> First: "+n[0].name+", Second: "+n[1].name+", Third: "+n[2]+"<br>\n"),parseInt(n[2])==n[2]&&(n[2]=parseInt(2*n[2])),s=e.create("ellipse",n,a)}catch(g){return JXG.debug("* <b>Err:</b> Ellipse "+a.name+"<br>\n"),!1}break;case"conic":if(a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a),n&&5==n.length)s=e.create("conic",n,a);else if(r.getElementsByTagName("matrix")){p=[];for(var S=0;r.getElementsByTagName("matrix")[0].attributes.length>S;S++)p[S]=parseFloat(r.getElementsByTagName("matrix")[0].attributes[S].value);s=e.create("conic",p,a)}return s;case"circlesector":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>CircleSector:</b> First: "+n[0].name+", Second: "+n[1].name+", Third: "+n[2].name+"<br>\n"),s=e.create("sector",[n[0],n[1],n[2]],a)}catch(g){return JXG.debug("* <b>Err:</b> CircleSector "+a.name+"<br>\n"),!1}break;case"linebisector":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>LineBiSector (Mittelsenkrechte):</b> First: "+n[0].name+"<br>\n"),p=e.create("midpoint",n,{visible:!1}),JXG.isPoint(JXG.getRef(e,n[0].id))&&JXG.isPoint(JXG.getRef(e,n[1].id))?($=e.create("line",n,{visible:"false"}),s=e.create("perpendicular",[p,$],a)):s=e.create("perpendicular",[p,n[0]],a),s}catch(g){return JXG.debug("* <b>Err:</b> LineBiSector (Mittelsenkrechte) "+a.name+"<br>\n"),!1}break;case"ray":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Ray:</b> First: "+n[0].name+"<br>\n"),a.straightFirst=!0,a.straightLast=!1,s=e.create("line",[n[1],n[0]],a)}catch(g){return JXG.debug("* <b>Err:</b> Ray "+a.name+"<br>\n"),!1}break;case"tangent":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{switch(JXG.debug("* <b>Tangent:</b> First: "+n[0].name+", Sec.: "+n[1].name+"("+n[1].type+")<br>\n"),n[1].type){case 1330923344:return n[0].makeGlider(n[1]),s=e.create("tangent",[n[0]],a);case 1330922316:case 1330922319:var P=e.create("polar",[n[1],n[0]],{visible:!1}),M=e.create("intersection",[n[1],P,0],{visible:!1}),N=e.create("intersection",[n[1],P,1],{visible:!1}),B=e.create("line",[n[0],M],a),A={};A=JXG.GeogebraReader.colorProperties(t[1],A),A=JXG.GeogebraReader.visualProperties(t[1],A),A.name=t[1].getAttribute("label");var F=e.create("line",[n[0],N],A);return e.ggbElements[A.name]=F,[B,F]}}catch(g){return JXG.debug("* <b>Err:</b> Tangent "+a.name+" "+A.name+"<br>\n"),!1}break;case"circumcirclearc":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>CircumcircleArc:</b> First: "+n[0].name+"<br>\n"),s=e.create("circumcirclearc",n,a)}catch(g){return JXG.debug("* <b>Err:</b> CircumcircleArc "+a.name+"<br>\n"),!1}break;case"circumcirclesector":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>CircumcircleSector:</b> First: "+n[0].name+"<br>\n"),s=e.create("circumcirclesector",[n[0],n[1],n[2]],a)}catch(g){return JXG.debug("* <b>Err:</b> CircumcircleSector "+a.name+"<br>\n"),!1}break;case"semicircle":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Semicircle:</b> First: "+n[0].name+"<br>\n"),s=e.create("semicircle",[n[0],n[1]],a)}catch(g){return JXG.debug("* <b>Err:</b> Semicircle "+a.name+"<br>\n"),!1}break;case"angle":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Angle:</b> First: "+n[0].name+"<br>\n"),s=e.create("angle",n,a)}catch(g){return JXG.debug("* <b>Err:</b> Angle "+a.name+"<br>\n"),!1}break;case"angularbisector":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a),a.straightFirst=!0,a.straightLast=!0;try{return JXG.debug("* <b>Angularbisector:</b> First: "+n[0].name+"<br>\n"),s=e.create("bisector",n,a)}catch(g){return JXG.debug("* <b>Err:</b> Angularbisector "+a.name+"<br>\n"),!1}break;case"numeric":if(0==r.getElementsByTagName("slider").length)return l=JXG.GeogebraReader.getElement(r.getAttribute("label"),!0),l&&(l=l.getAttribute("exp"),l=JXG.GeogebraReader.functionParse("",l),l=JXG.GeogebraReader.ggbParse(l)),e.ggb[a.name]=Function("return "+l+";"),JXG.debug("value: "+e.ggb[a.name]()),e.ggb[a.name];if(a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),a=JXG.GeogebraReader.visualProperties(r,a),1==r.getElementsByTagName("slider").length){if(m=parseFloat(r.getElementsByTagName("slider")[0].getAttribute("x")),v=parseFloat(r.getElementsByTagName("slider")[0].getAttribute("y")),h=parseFloat(r.getElementsByTagName("slider")[0].getAttribute("width")),r.getElementsByTagName("slider")[0].getAttribute("absoluteScreenLocation")&&"true"==r.getElementsByTagName("slider")[0].getAttribute("absoluteScreenLocation")){var j=new JXG.Coords(JXG.COORDS_BY_SCREEN,[m,v],e);m=j.usrCoords[1],v=j.usrCoords[2]}"true"==r.getElementsByTagName("slider")[0].getAttribute("horizontal")?(r.getElementsByTagName("slider")[0].getAttribute("absoluteScreenLocation")&&"true"==r.getElementsByTagName("slider")[0].getAttribute("absoluteScreenLocation")&&(h/=e.unitX),b=m+h,y=v):(r.getElementsByTagName("slider")[0].getAttribute("absoluteScreenLocation")&&"true"==r.getElementsByTagName("slider")[0].getAttribute("absoluteScreenLocation")&&(h/=e.unitY),b=m,y=v+h),r.getElementsByTagName("animation")[0]?a.snapWidth=parseFloat(r.getElementsByTagName("animation")[0].getAttribute("step")):!1;try{return JXG.debug("* <b>Numeric:</b> First: "+a.name+"<br>\n"),a.withTicks=!1,s=e.create("slider",[[m,v],[b,y],[parseFloat(r.getElementsByTagName("slider")[0].getAttribute("min")),parseFloat(r.getElementsByTagName("value")[0].getAttribute("val")),parseFloat(r.getElementsByTagName("slider")[0].getAttribute("max"))]],a),s.setProperty({withLabel:!1}),s}catch(g){return JXG.debug("* <b>Err:</b> Numeric "+a.name+"<br>\n"),!1}}break;case"midpoint":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.exists(a.styleGGB)||(a.face="circle",a.fillColor=a.strokeColor,a.fillOpacity=1,a.highlightFillColor=a.strokeColor,a.highlightFillOpacity=1,a.strokeColor="black",a.strokeWidth="1px"),s=e.create("midpoint",n,a),JXG.debug("* <b>Midpoint ("+s.id+"):</b> "+a.name+"("+o.x+", "+o.y+")<br>\n"),s}catch(g){return JXG.debug("* <b>Err:</b> Midpoint "+a.name+"<br>\n"),!1}break;case"center":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.exists(a.styleGGB)||(a.face="circle",a.fillColor=a.strokeColor,a.fillOpacity=1,a.highlightFillColor=a.strokeColor,a.highlightFillOpacity=1,a.strokeColor="black",a.strokeWidth="1px"),s=e.create("point",[function(){return JXG.getRef(e,n[0].id).center.X()},function(){return JXG.getRef(e,n[0].id).center.Y()}],a),JXG.debug("* <b>Center ("+s.id+"):</b> "+a.name+"("+o.x+", "+o.y+")<br>\n"),s}catch(g){return JXG.debug("* <b>Err:</b> Center "+a.name+"<br>\n"),!1}break;case"function":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a),JXG.GeogebraReader.getElement(a.name,!0)?(x=JXG.GeogebraReader.getElement(a.name,!0).getAttribute("exp"),x=JXG.GeogebraReader.functionParse("c",x)):(x=n[0],x=JXG.GeogebraReader.functionParse("s",x)),JXG.debug(x),h=x.length,x[x.length-1]="return "+JXG.GeogebraReader.ggbParse(x[x.length-1])+";",JXG.debug(x),w=[n&&n[1]?n[1]:null,n&&n[2]?n[2]:null];try{return 1==h?s=e.create("functiongraph",[Function(x[0]),w[0],w[1]],a):2==h?s=e.create("functiongraph",[Function(x[0],x[1]),w[0],w[1]],a):3==h?s=e.create("functiongraph",[Function(x[0],x[1],x[2]),w[0],w[1]],a):4==h?s=e.create("functiongraph",[Function(x[0],x[1],x[2],x[3]),w[0],w[1]],a):5==h&&(s=e.create("functiongraph",[Function(x[0],x[1],x[2],x[3],x[4]),w[0],w[1]],a)),s}catch(g){return JXG.debug("* <b>Err:</b> Functiongraph "+a.name+"<br>\n"),!1}break;case"polar":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{return JXG.debug("* <b>Polar:</b> First: "+n[0].name+", Sec.: "+n[1].name+"<br>\n"),s=e.create("polar",n,a)}catch(g){return JXG.debug("* <b>Err:</b> Polar "+a.name+"<br>\n"),!1}break;case"slope":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{JXG.debug("* <b>Slope ("+a.name+"):</b> First: "+n[0].name+"<br>\n");var G=parseInt(a.slopeWidth)||1,z=n[0].glider||n[0].point1,I=e.create("point",[function(){return G+z.X()},function(){return z.Y()}],{visible:!1}),H=e.create("segment",[z,I],{visible:!1}),X=e.create("normal",[H,H.point2],{visible:!1}),S=e.create("intersection",[n[0],X,0],{visible:!1}),p=e.create("midpoint",[H.point2,S],{visible:!1}),$=e.create("text",[function(){return p.X()},function(){return p.Y()},function(){return"&nbsp;&nbsp;"+(G>1?""+G:"")+" "+this.name+" = "+JXG.trimNumber((G*n[0].getSlope()).toFixed(JXG.GeogebraReader.decimals))}],a);a.name="";var F=e.create("text",[function(){return(z.X()+I.X())/2},function(){return z.Y()},function(){return"<br/>"+G}],a);$.Value=function(){return function(){return n[0].getSlope()}}();var J=e.create("polygon",[z,I,S],a);return J.borders[2].setProperty({visible:!1}),J.borders[0].setProperty({strokeColor:a.fillColor,strokeWidth:a.strokeWidth,highlightStrokeColor:a.fillColor,dash:a.dash}),J.borders[1].setProperty({strokeColor:a.fillColor,strokeWidth:a.strokeWidth,highlightStrokeColor:a.fillColor,dash:a.dash}),$}catch(g){return JXG.debug("* <b>Err:</b> Slope "+a.name+"<br>\n"),!1}break;case"text":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);var W,K="";try{if(r.getElementsByTagName("isLaTeX")[0]&&"true"==r.getElementsByTagName("isLaTeX")[0].getAttribute("val")){for(JXG.GeogebraReader.board.options.text.useASCIIMathML=!0,$=JXG.GeogebraReader.getElement(a.name,!0).getAttribute("exp");W=$.match(/(.*?)" \+ (.+) \+ "(.*)/);){var U=JXG.GeogebraReader.ggbParse(RegExp.$2);K="string"==typeof U?K+RegExp.$1+U:K+RegExp.$1+'" + JXG.trimNumber(('+U+').toFixed(JXG.GeogebraReader.decimals)) + "',$=RegExp.$3}(W=$.match(/(.*?)" \+ (.+)/))?K=K+RegExp.$1+'" + JXG.trimNumber(('+JXG.GeogebraReader.ggbParse(RegExp.$2)+").toFixed(JXG.GeogebraReader.decimals))":K+=$,JXG.debug("Text: "+K),s=e.create("text",[o.x,o.y,Function("return "+K+";")],a)}else JXG.debug(JXG.GeogebraReader.getElement(a.name,!0).getAttribute("exp")),$=JXG.GeogebraReader.ggbParse(JXG.GeogebraReader.functionParse(!1,JXG.GeogebraReader.getElement(a.name,!0).getAttribute("exp"))),JXG.debug($[1]),s=e.create("text",[o.x,o.y,Function("return "+$[0]+' + " " + JXG.trimNumber(parseFloat('+$[1]+").toFixed(JXG.GeogebraReader.decimals));")],a);return JXG.debug("* <b>Text:</b> "+$+"<br>\n"),s}catch(g){return JXG.debug("* <b>Err:</b> Text: "+$+"<br>\n"),!1}break;case"root":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);for(var S=0;t.length>S;S++)t[S]=JXG.GeogebraReader.checkElement(t[S].getAttribute("label"));var V;for(V=JXG.isArray(n)?n[0]:n,S=0;t.length>S;S++)t[S].addConstraint([function(t){return function(){return e.root(V.Y,t,V)}}(t[S].X()),function(){return 0}]);return t;case"integral":a=JXG.GeogebraReader.boardProperties(o,r,a),a=JXG.GeogebraReader.colorProperties(r,a),o=JXG.GeogebraReader.coordinates(o,r),a=JXG.GeogebraReader.visualProperties(r,a);try{JXG.debug("* <b>Integral:</b> First: "+n[0].name+", Sec.: "+n[1].name+", Thir.: "+n[2].name+"<br>\n"),JXG.debug([n[1](),n[2]()]);var s=e.create("integral",[JXG.getRef(e,n[0]),[n[1],n[2]]],a);return s}catch(g){return JXG.debug("* <b>Err:</b> Integral "+a.name+g+"<br>\n"),!1}break;default:return!1}},this.readGeogebra=function(e,t){var n,i,r,o;t.ggbElements=[],t.ggb={},JXG.GeogebraReader.tree=e,JXG.GeogebraReader.board=t,JXG.GeogebraReader.format=parseFloat(JXG.GeogebraReader.tree.getElementsByTagName("geogebra")[0].getAttribute("format")),JXG.GeogebraReader.decimals=parseInt(JXG.GeogebraReader.tree.getElementsByTagName("geogebra")[0].getElementsByTagName("kernel")[0].getElementsByTagName("decimals")[0].getAttribute("val")),JXG.GeogebraReader.writeBoard(t),t=JXG.GeogebraReader.setDefaultOptions(t);for(var a=JXG.GeogebraReader.tree.getElementsByTagName("construction"),s=0;a.length>s;s++){for(var l=a[s].getElementsByTagName("command"),c=0;l.length>c;c++){i=l[c];var u=[];for(r=0;i.getElementsByTagName("input")[0].attributes.length>r;r++)n=i.getElementsByTagName("input")[0].attributes[r].value,u[r]=n.match(/\u00B0/)||!n.match(/\D/)||n.match(/Circle/)||"Function"==i.getAttribute("name")||n==parseFloat(n)?n:"xAxis"==n||"yAxis"==n?t.ggbElements[n]:JXG.GeogebraReader.checkElement(n);var d=[],h=i.getElementsByTagName("output")[0].attributes[0].value;for(r=0;i.getElementsByTagName("output")[0].attributes.length>r;r++)n=i.getElementsByTagName("output")[0].attributes[r].value,d[r]=JXG.GeogebraReader.getElement(n);if((t.ggbElements[h]===void 0||""==t.ggbElements[h])&&(t.ggbElements[h]=JXG.GeogebraReader.writeElement(t,d,u,i.getAttribute("name").toLowerCase()),t.ggbElements[h].borders))for(var r=0;t.ggbElements[h].borders.length>r;r++)t.ggbElements[t.ggbElements[h].borders[r].name]=t.ggbElements[h].borders[r]}JXG.debug("Restesammler: ");for(var p=a[s].getElementsByTagName("element"),c=0;p.length>c;c++){var i=p[c],n=i.getAttribute("label");if((t.ggbElements[n]===void 0||""==t.ggbElements[n])&&(t.ggbElements[n]=JXG.GeogebraReader.writeElement(t,i),o=JXG.GeogebraReader.getElement(n,!0))){var f=i.getAttribute("type");switch(f){case"text":case"function":break;default:JXG.GeogebraReader.ggbParse(o.getAttribute("exp"),n)}}}}t.unsuspendUpdate(),t.fullUpdate()},this.utf8replace=function(e){return e=e.match(/\u03C0/)?e.replace(/\u03C0/g,"PI"):e,e=e.match(/\u00B2/)?e.replace(/\u00B2/g,"^2"):e,e=e.match(/\u00B3/)?e.replace(/\u00B3/g,"^3"):e,e=e.match(/\u225F/)?e.replace(/\u225F/g,"=="):e,e=e.match(/\u2260/)?e.replace(/\u2260/g,"!="):e,e=e.match(/\u2264/)?e.replace(/\u2264/g,"<="):e,e=e.match(/\u2265/)?e.replace(/\u2265/g,">="):e,e=e.match(/\u2227/)?e.replace(/\u2227/g,"&&"):e,e=e.match(/\u2228/)?e.replace(/\u2228/g,"//"):e},this.prepareString=function(e,t){var n,i,r,o;if(t&&(o=JXG.Util.Base64.decode(e),"PK"!==o.slice(0,2)&&(o=JXG.Util.Base64.decode(e,!0)),e=o),0!=e.indexOf("<")){for(i=[],r=e.length,n=0;r>n;n++)i[n]=JXG.Util.asciiCharCodeAt(e,n);e=new JXG.Util.Unzip(i).unzipFile("geogebra.xml")}return e=JXG.Util.utf8Decode(e),e=JXG.GeogebraReader.utf8replace(e)},this.isGGBVector=function(e){return JXG.isArray(e)&&3==e.length&&1==e[0]}};